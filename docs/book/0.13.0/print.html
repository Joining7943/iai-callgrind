<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Iai-Callgrind Guide</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="Iai-Callgrind, a high-precision and consistent one-shot benchmarking framework/harness for Rust">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="css/dropdown.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="getting_help.html"><strong aria-hidden="true">2.</strong> Getting Help</a></li><li class="chapter-item expanded affix "><li class="part-title">Installation</li><li class="chapter-item expanded "><a href="installation/prerequisites.html"><strong aria-hidden="true">3.</strong> Prerequisites</a></li><li class="chapter-item expanded "><a href="installation/iai_callgrind.html"><strong aria-hidden="true">4.</strong> Iai-Callgrind</a></li><li class="chapter-item expanded affix "><li class="part-title">Benchmarks</li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Library Benchmarks</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">5.1.</strong> Important default behaviour</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.2.</strong> Quickstart</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.3.</strong> The #[library_benchmark] attribute</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.4.</strong> The #[bench] attribute</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.5.</strong> The #[benches] attribute</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.6.</strong> The library_benchmark_group! macro</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.7.</strong> The main! macro</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.8.</strong> Generic benchmark functions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.9.</strong> Comparing benchmark functions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.10.</strong> Configuration</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.11.</strong> Examples</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Binary Benchmarks</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> Important default behaviour</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Quickstart</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.</strong> Differences to library benchmarks</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.1.</strong> setup and teardown</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> The Sandbox</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.5.</strong> The Command's stdin and simulating piped input</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.6.</strong> Configure the exit code of the Command</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.7.</strong> Low level api</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.7.1.</strong> Intermixing high-level and low-level api</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.7.2.</strong> The binary_benchmark_attribute! macro</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.8.</strong> Examples</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Performance Regressions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Valgrind Tools</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Valgrind Client Requests</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Flamegraphs</div></li><li class="chapter-item expanded affix "><li class="part-title">Command-line and environment variables</li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Basic usage</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">12.</strong> Comparing with baselines</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.</strong> Controlling the output of iai-callgrind</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">13.1.</strong> Customize the output directory</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.</strong> Machine-readable output</div></li><li class="chapter-item expanded "><a href="cli_and_env/output/terminal_output.html"><strong aria-hidden="true">13.3.</strong> Showing terminal output of benchmarks</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.4.</strong> Changing the color output</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.5.</strong> Changing the logging output</div></li></ol></li><li class="chapter-item expanded "><li class="part-title">Examples</li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.</strong> Server</div></li><li class="chapter-item expanded affix "><li class="part-title">Troubleshooting</li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> I'm getting the error Sentinel ... not found</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.</strong> Running cargo bench results in an "Unrecognized Option" error</div></li><li class="chapter-item expanded affix "><li class="part-title">Comparison</li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Criterion</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Iai</div></li><li class="chapter-item expanded affix "><li class="part-title">Upgrading</li><li class="chapter-item expanded affix "><li class="part-title">0.12.3 -&gt; 0.13.0</li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        <div class="dropdown">
                          <button onclick="versionDropdown()" class="icon-button version-dropdown-button" type="button">Version</button>
                          <div id="version-dropdown" class="version-dropdown-content">
                            <a href="../latest/index.html">Latest</a>
                            <hr class="sidbar-spacer">
                            <script src="../versions.js"></script>
                          </div>
                        </div>
                    </div>

                    <h1 class="menu-title">Iai-Callgrind Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/iai-callgrind/iai-callgrind" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This is the guide for Iai-Callgrind, a benchmarking framework/harness which uses
<a href="https://valgrind.org/docs/manual/cl-manual.html">Valgrind's Callgrind</a> and
other Valgrind tools like DHAT, Massif, ... to provide extremely accurate and
consistent measurements of Rust code, making it perfectly suited to run in
environments like a CI.</p>
<p>Iai_Callgrind is fully documented in this guide and in the api documentation at
<a href="https://docs.rs/iai-callgrind/latest/iai_callgrind/">docs.rs</a>.</p>
<p>Iai-Callgrind is</p>
<ul>
<li><strong>Precise</strong>: High-precision measurements of <code>Instruction</code> counts and many
other metrics allow you to reliably detect very small optimizations and
performance and heap memory usage regressions of your code.</li>
<li><strong>Consistent</strong>: Iai-Callgrind can take accurate measurements even in
virtualized CI environments and make them comparable between different systems
completely negating the noise of the environment.</li>
<li><strong>Fast</strong>: Each benchmark is only run once, which is usually much faster than
benchmarks which measure execution and wall time, since wall time benchmarks
have to be run many times to increase their accuracy, detect outliers,
filter out noise, etc.</li>
<li><strong>Visualizable</strong>: Iai-Callgrind generates a Callgrind (DHAT, ...) profile of
the benchmarked code and can be configured to create flamegraph-like charts
from Callgrind metrics. In general, all Valgrind-compatible tools like
<a href="https://valgrind.org/docs/manual/cl-manual.html#cl-manual.callgrind_annotate-options">callgrind_annotate</a>,
<a href="https://kcachegrind.github.io/html/Home.html">kcachegrind</a> or <code>dh_view.html</code>
and others to analyze the results in detail are fully supported.</li>
<li><strong>Easy</strong>: The api to setup benchmarks is easy to use but also powerful making
complicated setups realizable. Concentrate more on profiling and your code
than on the framework.</li>
</ul>
<h2 id="design-philosophy"><a class="header" href="#design-philosophy">Design philosophy</a></h2>
<p>Iai-Callgrind benchmarks are designed to be runnable with <code>cargo bench</code>. The
benchmark files are expanded to a benchmarking harness which replaces the native
benchmark harness of <code>rust</code>. Iai-Callgrind abstracts the complicated parts and
repetitive tasks away and provides an easy to use and intuitive api.
Nevertheless, all configuration options for the <code>valgrind</code> invocation should be
easily accessible for the more sophisticated and advanced uses. The most
important rule for the overall design is: Concentrate more on profiling and your
code than on the framework.</p>
<h2 id="when-not-to-use-iai-callgrind"><a class="header" href="#when-not-to-use-iai-callgrind">When not to use Iai-Callgrind</a></h2>
<p>Although Iai-Callgrind is useful in many projects, there are cases where
Iai-Callgrind is not a good fit.</p>
<ul>
<li>If you need wall times, Iai-Callgrind cannot help you much. The estimation of
cpu cycles is not a replacement for wall times and is primarily designed to be
a relative metric to be used for comparison.</li>
<li>Iai-Callgrind cannot be run on Windows and platforms not supported by
Valgrind.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h1>
<p>Reach out to us on <a href="https://github.com/iai-callgrind/iai-callgrind/discussions">Github
Discussions</a> or open
an <a href="https://github.com/iai-callgrind/iai-callgrind/issues">Issue</a> in the
<a href="https://github.com/iai-callgrind/iai-callgrind">Iai-Callgrind
Repository</a>. Check the
open and closed issues in the issue board, maybe you can already find a solution
to your problem there.</p>
<p>The api documentation can be found on
<a href="https://docs.rs/iai-callgrind/latest/iai_callgrind/">docs.rs</a> but you might
also want to check out the <code>Troubleshooting</code> section in the sidebar of this
guide.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h1>
<p>In order to use Iai-Callgrind, you must have <a href="https://www.valgrind.org">Valgrind</a> installed. This
means that Iai-Callgrind cannot be used on platforms that are not supported by Valgrind.</p>
<h2 id="debug-symbols"><a class="header" href="#debug-symbols">Debug Symbols</a></h2>
<p>It's required to run the iai-callgrind benchmarks with debugging symbols
switched on. For example in your <code>~/.cargo/config</code> or your project's
<code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[profile.bench]
debug = true
</code></pre>
<p>Now, all benchmarks which are run with <code>cargo bench</code> include the debug symbols.
(See also <a href="https://doc.rust-lang.org/cargo/reference/profiles.html">Cargo
Profiles</a> and <a href="https://doc.rust-lang.org/cargo/reference/config.html">Cargo
Config</a>).</p>
<p>It's required that settings like <code>strip = true</code> or other configuration options
stripping the debug symbols need to be disabled explicitly for the <code>bench</code>
profile if you have changed this option for the <code>release</code> profile. For example:</p>
<pre><code class="language-toml">[profile.release]
strip = true

[profile.bench]
debug = true
strip = false
</code></pre>
<h2 id="installation-of-valgrind"><a class="header" href="#installation-of-valgrind">Installation of Valgrind</a></h2>
<p>Iai-Callgrind is intentionally independent from a specific version of valgrind.
However, Iai-Callgrind was only tested with versions of valgrind &gt;= <code>3.20.0</code>. It
is therefore highly recommended to use a recent version of valgrind. Bugs get
fixed, the supported platforms are expanded ... Also, if you want or need to,
<a href="https://sourceware.org/git/?p=valgrind.git;a=blob;f=README;h=eabcc6ad88c8cab6dfe73cfaaaf5543023c2e941;hb=HEAD">building valgrind from
source</a>
is usually a straight-forward process. Just make sure the <code>valgrind</code> binary is
in your <code>$PATH</code> so that <code>iai-callgrind</code> can find it.</p>
<h3 id="installation-of-valgrind-with-your-package-manager"><a class="header" href="#installation-of-valgrind-with-your-package-manager">Installation of valgrind with your package manager</a></h3>
<h4 id="alpine-linux"><a class="header" href="#alpine-linux">Alpine Linux</a></h4>
<pre><code class="language-bash">apk add just
</code></pre>
<h4 id="arch-linux"><a class="header" href="#arch-linux">Arch Linux</a></h4>
<pre><code class="language-bash">pacman -Sy valgrind
</code></pre>
<h4 id="debianubuntu"><a class="header" href="#debianubuntu">Debian/Ubuntu</a></h4>
<pre><code class="language-bash">apt-get install valgrind
</code></pre>
<h4 id="fedora-linux"><a class="header" href="#fedora-linux">Fedora Linux</a></h4>
<pre><code class="language-bash">dnf install valgrind
</code></pre>
<h4 id="freebsd"><a class="header" href="#freebsd">FreeBSD</a></h4>
<pre><code class="language-bash">pkg install valgrind
</code></pre>
<h4 id="valgrind-is-available-for-the-following-distributions"><a class="header" href="#valgrind-is-available-for-the-following-distributions">Valgrind is available for the following distributions</a></h4>
<p><a href="https://repology.org/project/valgrind/versions"><img src="https://repology.org/badge/vertical-allrepos/valgrind.svg" alt="Packaging status" /></a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iai-callgrind"><a class="header" href="#iai-callgrind">Iai-Callgrind</a></h1>
<p>Iai-Callgrind is divided into the library <code>iai-callgrind</code> and the benchmark runner
<code>iai-callgrind-runner</code>.</p>
<h2 id="installation-of-the-library"><a class="header" href="#installation-of-the-library">Installation of the library</a></h2>
<p>To start with Iai-Callgrind, add the following to your <code>Cargo.toml</code> file:</p>
<pre><code class="language-toml">[dev-dependencies]
iai-callgrind = "0.13.0"
</code></pre>
<p>or run</p>
<pre><code class="language-bash">cargo add --dev iai-callgrind@0.13.0
</code></pre>
<h2 id="installation-of-the-benchmark-runner"><a class="header" href="#installation-of-the-benchmark-runner">Installation of the benchmark runner</a></h2>
<p>To be able to run the benchmarks you'll also need the <code>iai-callgrind-runner</code>
binary installed somewhere in your <code>$PATH</code>. Otherwise, there is no need to
interact with <code>iai-callgrind-runner</code> as it is just an implementation detail.</p>
<h3 id="from-source"><a class="header" href="#from-source">From Source</a></h3>
<pre><code class="language-shell">cargo install --version 0.13.0 iai-callgrind-runner
</code></pre>
<p>There's also the possibility to install the binary somewhere else and point the
<code>IAI_CALLGRIND_RUNNER</code> environment variable to the absolute path of the
<code>iai-callgrind-runner</code> binary like so:</p>
<pre><code class="language-shell">cargo install --version 0.13.0 --root /tmp iai-callgrind-runner
IAI_CALLGRIND_RUNNER=/tmp/bin/iai-callgrind-runner cargo bench --bench my-bench
</code></pre>
<h3 id="binstall"><a class="header" href="#binstall">Binstall</a></h3>
<p>The <code>iai-callgrind-runner</code> binary is
<a href="https://github.com/iai-callgrind/iai-callgrind/releases/tag/v0.13.0">pre-built</a>
for most platforms supported by valgrind and easily installable with
<a href="https://github.com/cargo-bins/cargo-binstall">binstall</a></p>
<pre><code class="language-shell">cargo binstall iai-callgrind-runner@0.13.0
</code></pre>
<h2 id="updating"><a class="header" href="#updating">Updating</a></h2>
<p>When updating the <code>iai-callgrind</code> library, you'll also need to update
<code>iai-callgrind-runner</code> and vice-versa or else the benchmark runner will exit
with an error.</p>
<h3 id="in-the-github-ci"><a class="header" href="#in-the-github-ci">In the Github CI</a></h3>
<p>Since the <code>iai-callgrind-runner</code> version must match the <code>iai-callgrind</code> library
version it's best to automate this step in the CI. A job step in the github
actions CI could look like this</p>
<pre><code class="language-yaml">- name: Install iai-callgrind-runner
  run: |
    version=$(cargo metadata --format-version=1 |\
      jq '.packages[] | select(.name == "iai-callgrind").version' |\
      tr -d '"'
    )
    cargo install iai-callgrind-runner --version $version
</code></pre>
<p>Or, speed up the overall installation time with <code>binstall</code> using the
<a href="https://github.com/taiki-e/install-action">taiki-e/install-action</a></p>
<pre><code class="language-yaml">- uses: taiki-e/install-action@cargo-binstall
- name: Install iai-callgrind-runner
  run: |
    version=$(cargo metadata --format-version=1 |\
      jq '.packages[] | select(.name == "iai-callgrind").version' |\
      tr -d '"'
    )
    cargo binstall --no-confirm iai-callgrind-runner --version $version
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- markdownlint-disable MD041 MD033 -->
<h1 id="just-an-example"><a class="header" href="#just-an-example">Just an example</a></h1>
<p>Make a change</p>
<pre>
   <code class="hljs"><span style="color:#0A0">test_bin_bench_sandbox::my_group::with_sandbox</span> <span style="color:#0AA">sandbox_with_fixture</span><span style="color:#0AA">:</span><b><span style="color:#00A">("one_line.fix", true) -> target/release/file-exists one_line.fix true</span></b>
  Instructions:     <b>         340625</b>|340625          (<span style="color:#555">No change</span>)
  L1 Hits:          <b>         455224</b>|455224          (<span style="color:#555">No change</span>)
  L2 Hits:          <b>            731</b>|731             (<span style="color:#555">No change</span>)
  RAM Hits:         <b>           4044</b>|4044            (<span style="color:#555">No change</span>)
  Total read+write: <b>         459999</b>|459999          (<span style="color:#555">No change</span>)
  Estimated Cycles: <b>         600419</b>|600419          (<span style="color:#555">No change</span>)
<span style="color:#0A0">test_bin_bench_sandbox::my_group::with_sandbox</span> <span style="color:#0AA">sandbox_without_fixture</span><span style="color:#0AA">:</span><b><span style="color:#00A">("one_line.fix", false) -> target/release/file-exists one_line.fix false</span></b>
  Instructions:     <b>         340594</b>|340594          (<span style="color:#555">No change</span>)
  L1 Hits:          <b>         455169</b>|455169          (<span style="color:#555">No change</span>)
  L2 Hits:          <b>            731</b>|731             (<span style="color:#555">No change</span>)
  RAM Hits:         <b>           4041</b>|4041            (<span style="color:#555">No change</span>)
  Total read+write: <b>         459941</b>|459941          (<span style="color:#555">No change</span>)
  Estimated Cycles: <b>         600259</b>|600259          (<span style="color:#555">No change</span>)
<span style="color:#0A0">test_bin_bench_sandbox::my_group::without_sandbox</span> <span style="color:#0AA">check_file</span><span style="color:#0AA">:</span><b><span style="color:#00A">("benches/fixtures/one_line.fix", true) -> target/release/file-exists benches/fixtures/one_line.fix true</span></b>
  Instructions:     <b>         340493</b>|340493          (<span style="color:#555">No change</span>)
  L1 Hits:          <b>         455062</b>|455062          (<span style="color:#555">No change</span>)
  L2 Hits:          <b>            732</b>|732             (<span style="color:#555">No change</span>)
  RAM Hits:         <b>           4046</b>|4046            (<span style="color:#555">No change</span>)
  Total read+write: <b>         459840</b>|459840          (<span style="color:#555">No change</span>)
  Estimated Cycles: <b>         600332</b>|600332          (<span style="color:#555">No change</span>)
<span style="color:#0A0">test_bin_bench_sandbox::my_group::with_current_dir</span> <b><span style="color:#00A">() -> target/release/file-exists bar.txt true</span></b>
  Instructions:     <b>         340552</b>|340552          (<span style="color:#555">No change</span>)
  L1 Hits:          <b>         455139</b>|455139          (<span style="color:#555">No change</span>)
  L2 Hits:          <b>            730</b>|730             (<span style="color:#555">No change</span>)
  RAM Hits:         <b>           4041</b>|4041            (<span style="color:#555">No change</span>)
  Total read+write: <b>         459910</b>|459910          (<span style="color:#555">No change</span>)
  Estimated Cycles: <b>         600224</b>|600224          (<span style="color:#555">No change</span>)</code>
</pre>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">extern crate iai_callgrind;
</span>use iai_callgrind::{main, library_benchmark_group, library_benchmark};

fn my_teardown(value: u64) {
    eprintln!("Error output during teardown: {value}");
}

fn to_be_benchmarked(value: u64) -&gt; u64 {
    println!("Output to stdout: {value}");
    value + 10
}

#[library_benchmark]
#[bench::some_id(args = (10), teardown = my_teardown)]
fn my_bench(value: u64) -&gt; u64 {
    to_be_benchmarked(value)
}

library_benchmark_group!(
    name = my_bench_group;
    benchmarks = my_bench
);

<span class="boring">fn main() {
</span>main!(library_benchmark_groups = my_bench_group);
<span class="boring">}</span></code></pre></pre>
<pre><code class="language-text">Just some text
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="js/dropdown.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
